FROM dunglas/frankenphp

# Install MySQL, intl, and gd extensions
RUN install-php-extensions pdo_mysql mysqli intl gd

# Copy your application files
COPY . /app/public

# Set working directory
WORKDIR /app/public

# Install PHP dependencies if composer.json exists
RUN if [ -f composer.json ]; then \
    composer install --no-dev --optimize-autoloader; \
    fi

# Set proper permissions
RUN chown -R www-data:www-data /app/public

# Expose port
EXPOSE 80 443